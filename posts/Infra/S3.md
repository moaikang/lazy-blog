# S3

Simple Storage Service의 줄임말.

- 안전하고 가변적인(저장 공간이 스스로 몸집을 키웠다 줄였다 한다는 것) Object 저장 공간을 제공 (ex: Google Cloud)
- 편리한 UI 인터페이스를 통해 어디서나 쉽게 데이터를 저장하고 불러올 수 있음.
- 파일 크기는 0KB ~ 5TB까지 지원.
- 저장공간 무제한
- Bucket이라는 이름을 사용함 (디렉토리와 유사함)
- Bucket 이름은 고유해야 한다.
- S3는 Object 저장 공간. (key, value)

## S3 Object 구성 요소

- Key
- Value
- Version ID
- Metadata (언제 파일이 업로드 되었는지 등등... 데이터에 대한 데이터.)
- CORS (Cross Origin Resource Sharing): 한 버킷의 파일을 다른 버킷에서 접근 가능하게 해주는 기능

## S3 Data Consistency Model

1. Read after Write Consistency (PUT)
   - 파일을 올릴때 PUT Method를 이용함
   - 파일이 S3 버킷에 올라간다면 바로 사용할 수 있다는 것.
2. Eventual Consistency (UPDATE, DELETE)
   - 버킷에 올라간 파일 내용을 변경 혹은 삭제할 때, 바로 나타나지 않는다는 것.

## S3 스토리지 종류

- 일반 S3
  - 가장 보편적으로 사용되는 스토리지 타입
  - 높은 내구성(얼마나 데이터의 손실이 없는지), 가용성(데이터 접근이 얼마나 용이한지)
- S3 - IA (Infrequent Access)
  - 자주 접근되지는 않으나 접근시 빠른 접근이 요구되는 파일이 많을시 유용
  - 일반 S3에 비해 비용은 저렴하나 접근시 추가 비용 발생
    멀티 AZ를 통한 데이터 저장
- S3 - One Zone IA
  - 단일 AZ를 통한 데이터 저장
  - 단일 AZ에 의한 데이터 접근 제한 (조금 낮은 가용성)
  - 데이터 접근시 S3 - IA보다 20% 비용 저렴
- Glacier
  - 거의 접근하지 않을 데이터 저장시 유용
  - 매우 저렴한 비용
  - 데이터 접근시 대략 4-5시간 소요
  - Glacier: 빙하라는 뜻. 빙하에 데이터를 넣는다고 생각하면 된다.
- Intellient Tiering

  - 데이터 접근 주기가 불규칙할때 매우 유용
  - 2가지 티어 존재
    - 데이터접근이 없을때 (Infrequent Tier)
    - 데이터 접근이 많아지면 (Frequent Tier)
  - 데이터 접근 주기에 따라 두가지 티어중 하나로 선택됨
  - Frequent Tier가 비용이 약간 더 비쌈
  - 최고의 비용 절감 효율을 누릴 수 있음.

  ## S3 요금

  - GB당
  - PUT, GET, COPY 요청 횟수 당
  - 데이터 다운로드시, 다른 리소스로 전송시
  - Metadata (Object Tag)

  # S3 버킷 생성시 알아야 할 것들

  ## S3 사용 용례

  - 파일 저장소 (로그, 다양한 파일들(이미지, 비디오, 압축파일 등))
  - S3 버킷에 파일이 올라왔을 때, 특정 이벤트를 트리거 시켜, AWS 내부의 다른 서비스를 실행시키는 기능이 존재한다.
  - 웹사이트 호스팅
  - Route 53을 이용하여 도메인을 버킷에 걸어버릴수도 있음
  - CORS:

  S3 버켓을 최초 생성시 -> 비공개
  특정 유저에게 권한을 주고 싶으면

  1. 버켓 정책 변경 (Bucket Policy)
  2. 접근 제어 리스트 변경 (Access Control List)

  ## S3 암호화

  1. 파일 업/다운로드 시 (AWS가 알아서 해줌)

  - SSL/TLS

  2. 가만히 있을 때 일어나는 일

  - SSE-S3 (S3 버켓들의 고유한 키를 가지고 있찌만, SEE-S3는 마스터키를 가지고 있어서 일정시간마다 키 값을 변경 시킴)
  - SSE-KMS (누가 , 언제, 암호를 풀었는지에 대한 정보 저장)
  - SSE-C (암호키를 직접 다룰수 있어서, 직접 암호키를 변경 시켜 주어야 함.)

  3. S3 암호화 과정

  - PUT 요청이 생성됨.
  - 여기에 헤더가 설정되는데, 이 헤더는 암호화 하겠다는 뜻

  ## 실습

  - S3는 글로벌 버킷이기 때문에 리전을 선택할 필요가 없음
